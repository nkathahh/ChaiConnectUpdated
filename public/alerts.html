<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>System Alerts — ChaiConnect</title>
  <link rel="stylesheet" href="/css/farmer_dashboard_items.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>

    <script src="theme.js"></script>

  <div class="page-wrapper">

    <div class="page-header">
      <div class="page-header-left">
        <h1><i class="fas fa-bell"></i> System Alerts</h1>
        <p>Important notifications and updates from ChaiConnect.</p>
      </div>
    </div>

    <div id="alertsContainer">
      <div class="empty-state">
        <div class="empty-state-icon"><i class="fas fa-bell-slash"></i></div>
        <h3>Loading alerts…</h3>
      </div>
    </div>

  </div>

  <script>
    async function loadAlerts() {
      const container = document.getElementById('alertsContainer');
      try {
        const res  = await fetch('/alerts');
        const data = await res.json();

        if (data.success && data.alerts.length > 0) {
          container.innerHTML = data.alerts.map(alert => `
            <div class="alert-item">
              <h4><i class="fas fa-triangle-exclamation"></i> ${alert.title}</h4>
              <p>${alert.message}</p>
              <small><i class="fas fa-clock"></i>
                ${new Date(alert.created_at).toLocaleString('en-KE', { dateStyle: 'medium', timeStyle: 'short' })}
              </small>
            </div>
          `).join('');
        } else {
          container.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon"><i class="fas fa-bell-slash"></i></div>
              <h3>No alerts at the moment</h3>
              <p>You're all caught up! Check back later.</p>
            </div>`;
        }
      } catch {
        container.innerHTML = `
          <div class="notice notice-error">
            <i class="fas fa-exclamation-circle"></i> Failed to load alerts. Please try again.
          </div>`;
      }
    }

    window.onload = loadAlerts;
  </script>

</body>
</html>